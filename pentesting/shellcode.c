#include <stdio.h>
#include <string.h>

int main(){

//  char code[] = "\xeb\x1a\x5e\x48\x31\xc0\x04\x01\x48\x89\xc7\xba\x0c\x00\x00\x00\x0f\x05\x48\x31\xc0\x04\x3c\x48\x31\xff\x0f\x05\xe8\xe1\xff\xff\xff\x48\x65\x6c\x6c\x6f\x20\x77\x6f\x72\x6c\x64\x0a";

//  char jmp_call_pop_code[] = "\xeb\x1b\x5e\x48\x31\xc0\x04\x01\x48\x89\xc7\x48\x89\xfa\x80\xc2\x0b\x0f\x05\x48\x31\xc0\x04\x3c\x48\x31\xff\x0f\x05\xe8\xe0\xff\xff\xff\x48\x65\x6c\x6c\x6f\x20\x77\x6f\x72\x6c\x64\x0a";

//char hexlify_stack_code[] = "\x48\x31\xc0\x04\x01\x48\x89\xc7\x68\x72\x6c\x64\x0a\x48\xbb\x48\x65\x6c\x6c\x6f\x20\x57\x6f\x53\x48\x89\xe6\x48\x31\xd2\x80\xc2\x0c\x0f\x05\x48\x31\xc0\x04\x3c\x48\x31\xff\x0f\x05";

//char rip_rel_addr_code[] ="\xeb\x0c\x48\x65\x6c\x6c\x6f\x20\x77\x6f\x72\x6c\x64\x0a\x48\x31\xc0\x04\x01\x48\x89\xc7\x48\x8d\x35\xe5\xff\xff\xff\x48\x31\xd2\x80\xc2\x0c\x0f\x05\x48\x31\xc0\x04\x3c\x48\x31\xff\x0f\x05";

  char execve_code[] ="\x48\x31\xc0\x50\x48\xbb\x2f\x62\x69\x6e\x2f\x2f\x73\x68\x53\x48\x89\xe7\x50\x48\x89\xe2\x57\x48\x89\xe6\x48\x83\xc0\x3b\x0f\x05";
  
  //printf("Shellcode Length: %d\n", strlen(hexlify_stack_code));
  //printf("Shellcode Length: %d\n", strlen(rip_rel_addr_code));
  printf("Shellcode Length: %d\n", strlen(execve_code));

  (*(int (*)())execve_code)();
  //(*(int (*)())code)();
  //int (*ret)() = (int (*)())code;
  //ret();
}
